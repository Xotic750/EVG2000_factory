<html>
<head>
<META http-equiv="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">	
<meta HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT"> 


<meta name="description" content="DG834 1049">
<meta http-equiv="content-type" content="text/html;charset=ISO-8859-1">

	
<link rel="stylesheet" href="form.css">

<STYLE TYPE="text/javascript">
	classes.num.all.fontFamily = "Courier";
	classes.num.all.fontSize = "10pt" ;
</style>
<% script_get(); %>
<script language="javascript" type="text/javascript">

function loadvpivci(index)
{
    var cf = document.forms[0];
    var multiplex;
    var vpi;
    var vci;
    var service;
    var pcr;
    var scr;
    var mbs;
    switch(index)
    {
        case 0:
            vpi=cf.atm0_vpi.value;
            vci=cf.atm0_vci.value;
            multiplex=cf.atm0_encap.value;
            service = cf.atm0_service.value;
            pcr = cf.atm0_pcr.value;
            scr = cf.atm0_scr.value;
            mbs = cf.atm0_mbs.value;
            break;
        case 1:
            vpi=cf.atm1_vpi.value;
            vci=cf.atm1_vci.value;
            multiplex=cf.atm1_encap.value;  
            service = cf.atm1_service.value;
            pcr = cf.atm1_pcr.value;
            scr = cf.atm1_scr.value;
            mbs = cf.atm1_mbs.value;
            break;
        case 2:
            vpi=cf.atm2_vpi.value;
            vci=cf.atm2_vci.value;
            multiplex=cf.atm2_encap.value; 
            service = cf.atm2_service.value;
            pcr = cf.atm2_pcr.value;
            scr = cf.atm2_scr.value;
            mbs = cf.atm2_mbs.value;
            break;
        case 3:
            vpi=cf.atm3_vpi.value;
            vci=cf.atm3_vci.value;
            multiplex=cf.atm3_encap.value;
            service = cf.atm3_service.value;
            pcr = cf.atm3_pcr.value;
            scr = cf.atm3_scr.value;
            mbs = cf.atm3_mbs.value;
            break;
        case 4:
            vpi=cf.atm4_vpi.value;
            vci=cf.atm4_vci.value;
            multiplex=cf.atm4_encap.value;
            service = cf.atm4_service.value;
            pcr = cf.atm4_pcr.value;
            scr = cf.atm4_scr.value;
            mbs = cf.atm4_mbs.value;
            break;
        case 5:
            vpi=cf.atm5_vpi.value;
            vci=cf.atm5_vci.value;
            multiplex=cf.atm5_encap.value;
            service = cf.atm5_service.value;
            pcr = cf.atm5_pcr.value;
            scr = cf.atm5_scr.value;
            mbs = cf.atm5_mbs.value;
            break;
        case 6:
            vpi=cf.atm6_vpi.value;
            vci=cf.atm6_vci.value;
            multiplex=cf.atm6_encap.value;
            service = cf.atm6_service.value;
            pcr = cf.atm6_pcr.value;
            scr = cf.atm6_scr.value;
            mbs = cf.atm6_mbs.value;
            break;
        case 7:
            vpi=cf.atm7_vpi.value;
            vci=cf.atm7_vci.value;
            multiplex=cf.atm7_encap.value;
            service = cf.atm7_service.value;
            pcr = cf.atm7_pcr.value;
            scr = cf.atm7_scr.value;
            mbs = cf.atm7_mbs.value;
            break;
            
        default:
            alert("should not be here");
            break;                                                                                
    }
    if (multiplex == "LLC")
 	    cf.dsl_multiplex.selectedIndex = 0;
    else 
	    cf.dsl_multiplex.selectedIndex = 1;
    cf.dsl_vpi.value=vpi;
    cf.dsl_vci.value=vci;
    
    if (service == "ubr")
        cf.atm_qos.selectedIndex = 0;
    else if (service == "cbr")
        cf.atm_qos.selectedIndex = 1;
    else if (service == "rt_vbr")
        cf.atm_qos.selectedIndex = 2;
    else
        cf.atm_qos.selectedIndex = 3;
    
    cf.atm_pcr.value=pcr;
    cf.atm_scr.value=scr;
    cf.atm_mbs.value=mbs;
   
}

function Loadsettings(index)
{
    var cf = document.forms[0];
    cf.adslChoice.selectedIndex = cf.nowchoice.value;
    if (index == 100)
    {
        index = eval(cf.nowchoice.value);
    }
    loadvpivci(index);
}


function duplicatepvcChk(vpi, vci)
{
    var cf = document.forms[0];
    var index = cf.adslChoice.selectedIndex;
    if (( index != 0) && (vpi == cf.atm0_vpi.value) && (vci == cf.atm0_vci.value) && (cf.wan0_dial.value == "1"))
        return true;
    if ((index != 1) && (vpi == cf.atm1_vpi.value) && (vci == cf.atm1_vci.value) && (cf.wan1_dial.value == "1"))
        return true;
    if ((index != 2) && (vpi == cf.atm2_vpi.value) && (vci == cf.atm2_vci.value) && (cf.wan2_dial.value == "1"))
        return true;
    if ((index != 3) && (vpi == cf.atm3_vpi.value) && (vci == cf.atm3_vci.value) && (cf.wan3_dial.value == "1"))
        return true;
    if ((index != 4) && (vpi == cf.atm4_vpi.value) && (vci == cf.atm4_vci.value) && (cf.wan4_dial.value == "1"))
        return true;
    if ((index != 5) && (vpi == cf.atm5_vpi.value) && (vci == cf.atm5_vci.value) && (cf.wan5_dial.value == "1"))
        return true;
    if ((index != 6) && (vpi == cf.atm6_vpi.value) && (vci == cf.atm6_vci.value) && (cf.wan6_dial.value == "1"))
        return true;
    if ((index != 7) && (vpi == cf.atm7_vpi.value) && (vci == cf.atm7_vci.value) && (cf.wan7_dial.value == "1"))
        return true;
    return false;
}

function checkData()
{
    var cf = document.forms[0];
    var msg = "";
    var vpi = cf.dsl_vpi.value;
    var vci = cf.dsl_vci.value;

	var msg = checkInt(cf.dsl_vpi, "dsl_vpi", 0, 255, true);
	msg+=  checkInt(cf.dsl_vci, "dsl_vci", 32, 65535, true);
    
    if (duplicatepvcChk(vpi,vci))
       msg += "duplicate PVC found!\n";
    
	if (msg.length > 1)
	{
		alert(msg);
		return false;
	}
	if (cf.atm_qos.value != "ubr"){
		if(!isNum("PCR",cf.atm_pcr.value))
			return false;
		if(!isNum("SCR",cf.atm_scr.value))
			return false;
		if(!isNum("MBS",cf.atm_mbs.value))
			return false;
	}
	if (cf.atm_qos.value == "rt_vbr" || cf.atm_qos.value == "nrt_vbr"){
		if(cf.atm_pcr.value < 1 || cf.atm_pcr.value >1887){
			alert("PCR is out of range[1-1887]");
			return false;
			}
		if(cf.atm_scr.value < 1 || cf.atm_scr.value >1887){
			alert("SCR is out of range[1-1887]");
			return false;
			}
		if(parseInt(cf.atm_pcr.value,10) <= parseInt(cf.atm_scr.value,10)){
			alert("SCR has to be smaller than PCR.");
			return false;
			}
		if(cf.atm_mbs.value < 1 || cf.atm_mbs.value >1000000){
			alert("MBS is out of range[1-1000000]");
			return false;
			}
		}
	if (cf.atm_qos.value == "cbr"){
		if(cf.atm_pcr.value < 1 || cf.atm_pcr.value >1887){
			alert("PCR is out of range[1-1887]");
			return false;
			}
		}
	//dataToHidden(cf);
    cf.nowchoice.value = -1;
	return true;
}

function isNum(name,value)
{	
	var i = 0;
	for( i = 0;i < value.length;i++ ){
	if ( (value.charAt(i) >= '0') && (value.charAt(i) <= '9') )
			continue;
	else{
		alert("Invalid input!The "+name+" must be number!");
		return false;
		}
	}
	return true;
}
function chgQoS()
{
 	var cf = document.forms[0];
	var dflag = false;

	if (cf.atm_qos.value == "ubr")
		dflag = true;

	cf.atm_pcr.disabled = dflag;
	cf.atm_scr.disabled = dflag;
	cf.atm_mbs.disabled = dflag;
	if (cf.atm_qos.value == "cbr"){
		cf.atm_scr.disabled = true;
		cf.atm_mbs.disabled = true;
		
		}
}

function loadcheck()
{
    loadhelp('BAS_dsl');
    document.forms[0].elements[0].focus();
    chgQoS();
}

function ChangeAdslChoice()
{
 	var cf = document.forms[0];    
    var tmpstr;
    var index = cf.adslChoice.selectedIndex;
    
    tmpstr = "adsl.cgi?nowchoice=" + index + "&nowproto=9";
    location.href = tmpstr;
    
}

</script>
<title>ADSL Settings</title>
</head>

<body bgcolor="#ffffff" onLoad="Loadsettings(100);loadcheck();">
<form name="formname" method="post" action="adsl.cgi">
<table border="0" cellpadding="0" cellspacing="3" width="100%">
<tr>
	<td colspan="2"><h1>WAN Settings</h1></td>
</tr>

<tr>
  <td nowrap width="50%"><select name="adslChoice" size="1" onChange=ChangeAdslChoice()>
    <option value="0">WAN1</option>
    <option value="1">WAN2</option>
    <option value="2">WAN3</option>
    <option value="3">WAN4</option>
    <option value="4">WAN5</option>
    <option value="5">WAN6</option>
    <option value="6">WAN7</option>
    <option value="7">WAN8</option>
    </script>
  </select></td>
  <td nowrap width="50%" align="right">&nbsp;</td>
</tr>
<tr>  <!-- RULE -->
  <td colspan="2" background="liteblue.gif" height="12">&nbsp; </td>
</tr>

<tr>
 <td nowrap width="50%">Multiplexing Method</TD>
 <td width="50%" align="right"><select name="dsl_multiplex" size="1">
   <option value="LLC">LLC-BASED</option>
   <option value="VC">VC-BASED</option>
 </select></TD>
</TR>
<TR>
  <td nowrap width="50%">VPI</td>
  <td nowrap width="50%" align="right"><input type="text" name="dsl_vpi" class="num" value="" size="3" maxlength="3"></td>
</tr>
<TR>
  <td nowrap width="50%">VCI</td>
  <td nowrap width="50%" align="right"><input type="text" name="dsl_vci" class="num" value="" size="5" maxlength="5"></td>
</tr>



<tr>  <!-- RULE -->
  <td colspan="2" background="liteblue.gif" height="12">&nbsp; </td>
</tr>
<tr>
 <td nowrap width="50%">ATM Traffic Class</TD>
 <td width="50%" align="right"><SELECT name="atm_qos" size="1" onChange="chgQoS()">
   <option value="ubr">UBR</option>
   <option value="cbr">CBR</option>
   <option value="rt_vbr">VBR-rt</option>
   <option value="nrt_vbr">VBR-nrt</option>
 </SELECT></TD>
</TR>
<tr>
 <td nowrap width="50%">PCR : [cells/s]</TD>
 <td width="50%" align="right"><input type="text" class="num" name="atm_pcr" value="0" size="15" maxlength="15"></TD>
</TR>
<tr>
  <td nowrap>SCR : [cells/s]</TD>
  <td align="right"><input type="text" name="atm_scr" class="num" value="0" size="15" maxlength="15"></TD>
</TR>
<tr>
 <td nowrap width="50%">MBS : [cells]</TD>
 <td width="50%" align="right"><input type="text" name="atm_mbs" class="num" value="0" size="15" maxlength="15"></TD>
</TR>
<tr>
  <td colspan="2" background="liteblue.gif" height="12">&nbsp;</td>
</tr>
<tr>  <!-- RULE -->
  <td colspan="2" align="center">
    <input type="SUBMIT" name="apply" value="Apply" onClick="return checkData();">
    <input type="RESET" name="Cancel" value="Cancel" onClick="location.href='BAS_dsl.htm'">

</tr>
</table>
  <INPUT name=nowchoice type=hidden value= "<% nvram_get("nowchoice"); %>">
  
  <INPUT name=atm0_vpi type=hidden value= "<% nvram_get("atmVcc0_vpi"); %>">
  <INPUT name=atm0_vci type=hidden value= "<% nvram_get("atmVcc0_vci"); %>">
  <INPUT name=atm0_multiplex type=hidden value= "<% nvram_get("atmVcc0_multiplex"); %>">
  <INPUT name=atm0_encap type=hidden value= "<% nvram_get("atmVcc0_encap"); %>">
  <INPUT name=atm0_service type=hidden value= "<% nvram_get("atmTd0_service"); %>">
  <INPUT name=atm0_pcr type=hidden value= "<% nvram_get("atmTd0_peakCellRate"); %>">
  <INPUT name=atm0_scr type=hidden value= "<% nvram_get("atmTd0_sustainedCellRate"); %>">
  <INPUT name=atm0_mbs type=hidden value= "<% nvram_get("atmTd0_maxBurstSize"); %>">    
    
  <INPUT name=atm1_vpi type=hidden value= "<% nvram_get("atmVcc1_vpi"); %>">
  <INPUT name=atm1_vci type=hidden value= "<% nvram_get("atmVcc1_vci"); %>">
  <INPUT name=atm1_multiplex type=hidden value= "<% nvram_get("atmVcc1_multiplex"); %>">
  <INPUT name=atm1_encap type=hidden value= "<% nvram_get("atmVcc1_encap"); %>">  
  <INPUT name=atm1_service type=hidden value= "<% nvram_get("atmTd1_service"); %>">
  <INPUT name=atm1_pcr type=hidden value= "<% nvram_get("atmTd1_peakCellRate"); %>">
  <INPUT name=atm1_scr type=hidden value= "<% nvram_get("atmTd1_sustainedCellRate"); %>">
  <INPUT name=atm1_mbs type=hidden value= "<% nvram_get("atmTd1_maxBurstSize"); %>"> 
  
  <INPUT name=atm2_vpi type=hidden value= "<% nvram_get("atmVcc2_vpi"); %>">
  <INPUT name=atm2_vci type=hidden value= "<% nvram_get("atmVcc2_vci"); %>">
  <INPUT name=atm2_multiplex type=hidden value= "<% nvram_get("atmVcc2_multiplex"); %>">
  <INPUT name=atm2_encap type=hidden value= "<% nvram_get("atmVcc2_encap"); %>">  
  <INPUT name=atm2_service type=hidden value= "<% nvram_get("atmTd2_service"); %>">
  <INPUT name=atm2_pcr type=hidden value= "<% nvram_get("atmTd2_peakCellRate"); %>">
  <INPUT name=atm2_scr type=hidden value= "<% nvram_get("atmTd2_sustainedCellRate"); %>">
  <INPUT name=atm2_mbs type=hidden value= "<% nvram_get("atmTd2_maxBurstSize"); %>"> 
  
  <INPUT name=atm3_vpi type=hidden value= "<% nvram_get("atmVcc3_vpi"); %>">
  <INPUT name=atm3_vci type=hidden value= "<% nvram_get("atmVcc3_vci"); %>">
  <INPUT name=atm3_multiplex type=hidden value= "<% nvram_get("atmVcc3_multiplex"); %>">
  <INPUT name=atm3_encap type=hidden value= "<% nvram_get("atmVcc3_encap"); %>">  
  <INPUT name=atm3_service type=hidden value= "<% nvram_get("atmTd3_service"); %>">
  <INPUT name=atm3_pcr type=hidden value= "<% nvram_get("atmTd3_peakCellRate"); %>">
  <INPUT name=atm3_scr type=hidden value= "<% nvram_get("atmTd3_sustainedCellRate"); %>">
  <INPUT name=atm3_mbs type=hidden value= "<% nvram_get("atmTd3_maxBurstSize"); %>"> 
  
  <INPUT name=atm4_vpi type=hidden value= "<% nvram_get("atmVcc4_vpi"); %>">
  <INPUT name=atm4_vci type=hidden value= "<% nvram_get("atmVcc4_vci"); %>">
  <INPUT name=atm4_multiplex type=hidden value= "<% nvram_get("atmVcc4_multiplex"); %>">
  <INPUT name=atm4_encap type=hidden value= "<% nvram_get("atmVcc4_encap"); %>">  
  <INPUT name=atm4_service type=hidden value= "<% nvram_get("atmTd4_service"); %>">
  <INPUT name=atm4_pcr type=hidden value= "<% nvram_get("atmTd4_peakCellRate"); %>">
  <INPUT name=atm4_scr type=hidden value= "<% nvram_get("atmTd4_sustainedCellRate"); %>">
  <INPUT name=atm4_mbs type=hidden value= "<% nvram_get("atmTd4_maxBurstSize"); %>"> 
  
  <INPUT name=atm5_vpi type=hidden value= "<% nvram_get("atmVcc5_vpi"); %>">
  <INPUT name=atm5_vci type=hidden value= "<% nvram_get("atmVcc5_vci"); %>">
  <INPUT name=atm5_multiplex type=hidden value= "<% nvram_get("atmVcc5_multiplex"); %>">
  <INPUT name=atm5_encap type=hidden value= "<% nvram_get("atmVcc5_encap"); %>"> 
  <INPUT name=atm5_service type=hidden value= "<% nvram_get("atmTd5_service"); %>">
  <INPUT name=atm5_pcr type=hidden value= "<% nvram_get("atmTd5_peakCellRate"); %>">
  <INPUT name=atm5_scr type=hidden value= "<% nvram_get("atmTd5_sustainedCellRate"); %>">
  <INPUT name=atm5_mbs type=hidden value= "<% nvram_get("atmTd5_maxBurstSize"); %>"> 
  
  <INPUT name=atm6_vpi type=hidden value= "<% nvram_get("atmVcc6_vpi"); %>">
  <INPUT name=atm6_vci type=hidden value= "<% nvram_get("atmVcc6_vci"); %>">
  <INPUT name=atm6_multiplex type=hidden value= "<% nvram_get("atmVcc6_multiplex"); %>">
  <INPUT name=atm6_encap type=hidden value= "<% nvram_get("atmVcc6_encap"); %>"> 
  <INPUT name=atm6_service type=hidden value= "<% nvram_get("atmTd6_service"); %>">
  <INPUT name=atm6_pcr type=hidden value= "<% nvram_get("atmTd6_peakCellRate"); %>">
  <INPUT name=atm6_scr type=hidden value= "<% nvram_get("atmTd6_sustainedCellRate"); %>">
  <INPUT name=atm6_mbs type=hidden value= "<% nvram_get("atmTd6_maxBurstSize"); %>"> 
  
  <INPUT name=atm7_vpi type=hidden value= "<% nvram_get("atmVcc7_vpi"); %>">
  <INPUT name=atm7_vci type=hidden value= "<% nvram_get("atmVcc7_vci"); %>">
  <INPUT name=atm7_multiplex type=hidden value= "<% nvram_get("atmVcc7_multiplex"); %>">
  <INPUT name=atm7_encap type=hidden value= "<% nvram_get("atmVcc7_encap"); %>">
  <INPUT name=atm7_service type=hidden value= "<% nvram_get("atmTd7_service"); %>">
  <INPUT name=atm7_pcr type=hidden value= "<% nvram_get("atmTd7_peakCellRate"); %>">
  <INPUT name=atm7_scr type=hidden value= "<% nvram_get("atmTd7_sustainedCellRate"); %>">
  <INPUT name=atm7_mbs type=hidden value= "<% nvram_get("atmTd7_maxBurstSize"); %>"> 
  
  <INPUT name=wan0_dial type=hidden value= "<% adsl_dial_flag(0); %>">
  <INPUT name=wan1_dial type=hidden value= "<% adsl_dial_flag(1); %>">
  <INPUT name=wan2_dial type=hidden value= "<% adsl_dial_flag(2); %>">
  <INPUT name=wan3_dial type=hidden value= "<% adsl_dial_flag(3); %>">
  <INPUT name=wan4_dial type=hidden value= "<% adsl_dial_flag(4); %>">
  <INPUT name=wan5_dial type=hidden value= "<% adsl_dial_flag(5); %>">
  <INPUT name=wan6_dial type=hidden value= "<% adsl_dial_flag(6); %>">
  <INPUT name=wan7_dial type=hidden value= "<% adsl_dial_flag(7); %>">

</form>
</body>
</html>



